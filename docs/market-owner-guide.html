<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Market Owner Guide - Lendefi Markets</title>
    <!-- Prism.js for syntax highlighting -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #e5e7eb;
            background: #111827;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        header {
            background: rgba(17, 24, 39, 0.9);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding: 1rem 0;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .logo span {
            background: linear-gradient(135deg, #0ea5e9, #14b8a6);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            font-size: 1.5rem;
            font-weight: bold;
        }
        
        .nav-links {
            display: flex;
            gap: 2rem;
        }
        
        .nav-links a {
            color: #9ca3af;
            text-decoration: none;
            transition: color 0.3s;
        }
        
        .nav-links a:hover {
            color: #14b8a6;
        }
        
        main {
            padding: 2rem 0;
        }
        
        .docs-header {
            text-align: center;
            margin-bottom: 3rem;
        }
        
        .docs-header h1 {
            font-size: 3rem;
            margin-bottom: 1rem;
        }
        
        .gradient-text {
            background: linear-gradient(135deg, #0ea5e9, #14b8a6);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .docs-content {
            display: grid;
            grid-template-columns: 250px 1fr;
            gap: 3rem;
        }
        
        .sidebar {
            background: rgba(17, 24, 39, 0.5);
            padding: 2rem;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            height: fit-content;
            position: sticky;
            top: 120px;
        }
        
        .sidebar h3 {
            color: #14b8a6;
            margin-bottom: 1rem;
            font-size: 1.1rem;
        }
        
        .sidebar ul {
            list-style: none;
        }
        
        .sidebar li {
            margin-bottom: 0.5rem;
        }
        
        .sidebar a {
            color: #9ca3af;
            text-decoration: none;
            padding: 0.5rem;
            display: block;
            border-radius: 6px;
            transition: all 0.3s;
        }
        
        .sidebar a:hover {
            background: rgba(20, 184, 166, 0.1);
            color: #14b8a6;
        }
        
        .content {
            background: rgba(17, 24, 39, 0.5);
            padding: 3rem;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .content h2 {
            color: #14b8a6;
            margin-bottom: 1.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .content h3 {
            color: #0ea5e9;
            margin: 2rem 0 1rem 0;
        }
        
        .content h4 {
            color: #f59e0b;
            margin: 1.5rem 0 0.75rem 0;
        }
        
        .content p, .content li {
            margin-bottom: 1rem;
            color: #d1d5db;
        }
        
        .content ul, .content ol {
            margin-left: 2rem;
            margin-bottom: 1rem;
        }
        
        .highlight {
            background: rgba(20, 184, 166, 0.1);
            border-left: 4px solid #14b8a6;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 0 6px 6px 0;
        }
        
        .warning {
            background: rgba(245, 158, 11, 0.1);
            border-left: 4px solid #f59e0b;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 0 6px 6px 0;
        }
        
        .step-card {
            background: rgba(31, 41, 55, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1rem 0;
            position: relative;
        }
        
        .step-number {
            position: absolute;
            top: -10px;
            left: 20px;
            background: #14b8a6;
            color: #111827;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.875rem;
        }
        
        .step-title {
            color: #0ea5e9;
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
            margin-top: 0.5rem;
        }
        
        .code-block {
            background: #1f2937;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1rem 0;
            overflow-x: auto;
        }
        
        .code-block code {
            color: #e5e7eb;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 0.875rem;
        }
        
        .tab-navigation {
            display: flex;
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 24px;
            gap: 8px;
        }
        
        .tab-button {
            padding: 12px 24px;
            background: transparent;
            border: none;
            border-bottom: 2px solid transparent;
            color: #9ca3af;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            border-radius: 6px 6px 0 0;
            transition: all 0.2s;
        }
        
        .tab-button.active {
            color: #60a5fa;
            background: rgba(59, 130, 246, 0.2);
            border-bottom-color: #3b82f6;
        }
        
        .config-example {
            background: rgba(17, 24, 39, 0.8);
            border-radius: 8px;
            padding: 24px;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 0.875rem;
            margin: 1rem 0;
        }
        
        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
            margin: 24px 0;
        }
        
        .info-box {
            border-radius: 8px;
            padding: 16px;
            margin: 1rem 0;
        }
        
        .info-box.blue {
            background: rgba(59, 130, 246, 0.1);
            border: 1px solid rgba(59, 130, 246, 0.3);
        }
        
        .info-box.green {
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid rgba(16, 185, 129, 0.3);
        }
        
        .info-box.yellow {
            background: rgba(245, 158, 11, 0.1);
            border: 1px solid rgba(245, 158, 11, 0.3);
        }
        
        .info-box.purple {
            background: rgba(139, 92, 246, 0.1);
            border: 1px solid rgba(139, 92, 246, 0.3);
        }
        
        .info-box.red {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
        }
        
        @media (max-width: 768px) {
            .docs-content {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                position: static;
            }
            
            .docs-header h1 {
                font-size: 2rem;
            }
            
            .grid-2 {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <nav class="nav">
                <div class="logo">
                    <span>Lendefi Markets</span>
                </div>
                <div class="nav-links">
                    <a href="/">Home</a>
                    <a href="index.html">Documentation</a>
                    <a href="lender-guide.html">Lender Guide</a>
                    <a href="borrower-guide.html">Borrower Guide</a>
                    <a href="/contact">Contact</a>
                </div>
            </nav>
        </div>
    </header>

    <main>
        <div class="container">
            <div class="docs-header">
                <h1><span class="gradient-text">Market Owner</span> Guide</h1>
                <p>Complete guide to creating and managing isolated lending markets in Lendefi Protocol</p>
            </div>

            <div class="docs-content">
                <aside class="sidebar">
                    <h3>Table of Contents</h3>
                    <ul>
                        <li><a href="#introduction">Introduction</a></li>
                        <li><a href="#create-market">1. Create Your Market</a></li>
                        <li><a href="#configure-assets">2. Configure Assets</a></li>
                        <li><a href="#asset-examples">Asset Configuration Examples</a></li>
                        <li><a href="#deploy-liquidity">3. Deploy Initial Liquidity</a></li>
                        <li><a href="#manage-market">4. Manage Your Market</a></li>
                        <li><a href="#revenue-streams">Revenue Streams</a></li>
                        <li><a href="#best-practices">Best Practices</a></li>
                        <li><a href="#quick-reference">Quick Reference</a></li>
                    </ul>
                </aside>

                <div class="content">
                    <section id="introduction">
                        <h2>🚀 Welcome, Market Owner!</h2>
                        <p>As a market owner in Lendefi Markets, you have the power to create and manage isolated lending markets for any ERC-20 asset. This guide will walk you through the complete process from creation to launch.</p>
                        
                        <div class="info-box blue">
                            <strong>🔥 New Feature:</strong> Market owners now automatically receive <code>MANAGER_ROLE</code> during market creation, enabling immediate configuration without waiting for DAO governance!
                        </div>

                        <div class="highlight">
                            <strong>Key Benefits of Being a Market Owner:</strong>
                            <ul>
                                <li>Create isolated lending markets for any approved base asset</li>
                                <li>Earn revenue from interest spreads, liquidation fees, and flash loans</li>
                                <li>Configure risk parameters and asset settings</li>
                                <li>Build your own DeFi lending ecosystem</li>
                                <li>Complete control over market parameters and asset configurations</li>
                            </ul>
                        </div>
                    </section>

                    <section id="create-market">
                        <h2>Step 1: Create Your Market</h2>
                        <p>The first step is to create your lending market through the factory contract. This establishes your isolated liquidity pool for a specific base asset.</p>

                        <div class="step-card">
                            <div class="step-number">1</div>
                            <div class="step-title">Obtain Market Owner Role</div>
                            <p>Get the necessary permissions to create markets in the Lendefi ecosystem.</p>
                            
                            <div class="info-box yellow">
                                <strong>Prerequisites:</strong>
                                <ul>
                                    <li>Must be granted <code>MARKET_OWNER_ROLE</code> by protocol governance</li>
                                    <li>Submit a governance proposal or contact the protocol team</li>
                                    <li>Meet any requirements for market ownership (KYC, audits, etc.)</li>
                                    <li>Understand the responsibilities of market ownership</li>
                                </ul>
                            </div>
                        </div>

                        <div class="step-card">
                            <div class="step-number">2</div>
                            <div class="step-title">Choose Your Base Asset</div>
                            <p>Select the base asset for your lending market from the approved asset list.</p>
                            
                            <div class="info-box green">
                                <strong>Base Asset Requirements:</strong>
                                <ul>
                                    <li>Asset must be in the allowed base assets list</li>
                                    <li>Check with <code>isBaseAssetAllowed(address)</code></li>
                                    <li>Popular options: USDC, USD1, USDT, WETH</li>
                                    <li>Each market is specific to one base asset</li>
                                </ul>
                            </div>
                        </div>

                        <div class="step-card">
                            <div class="step-number">3</div>
                            <div class="step-title">Deploy Your Market</div>
                            <p>Call the factory contract to deploy your complete lending infrastructure.</p>
                            
                            <div class="code-block">
                                <pre><code class="language-solidity">// Deploy a new USDC lending market
factory.createMarket(
    0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48, // USDC address
    "Lendefi USDC Market",                         // Market name
    "LMUSDC"                                       // Market symbol
);</code></pre>
                            </div>

                            <div class="info-box blue">
                                <strong>What gets deployed during market creation:</strong>
                                <ul>
                                    <li>✅ Core contract deployed for borrower position management</li>
                                    <li>✅ ERC-4626 vault deployed for lender deposits and withdrawals</li>
                                    <li>✅ Position vault deployed for borrower collateral isolation</li>
                                    <li>✅ Assets module cloned with your configuration permissions</li>
                                    <li>✅ PoR feed deployed for proof-of-reserves tracking</li>
                                    <li>✅ <strong>MANAGER_ROLE granted to you automatically</strong></li>
                                </ul>
                            </div>
                        </div>

                        <div class="warning">
                            <strong>⚠️ Important:</strong> Gas cost for market creation is approximately 2-3M gas. Ensure you have sufficient ETH for deployment and understand the ongoing responsibilities of market ownership.
                        </div>
                    </section>

                    <section id="configure-assets">
                        <h2>Step 2: Configure Your Assets Module</h2>
                        <p>This is the most critical step! You must configure <strong>ALL</strong> assets in your market - both your <strong>base asset</strong> (the token lenders supply and borrowers receive) and <strong>every collateral asset</strong> that borrowers can deposit to secure their loans.</p>

                        <div class="info-box blue">
                            <h4>🔧 Required Configurations</h4>
                            <ul>
                                <li><strong>Base Asset:</strong> The token lenders supply and borrowers borrow (e.g., USDC in a USDC market)</li>
                                <li><strong>Collateral Assets:</strong> Tokens borrowers deposit as security to borrow the base asset (e.g., ETH, WBTC, USD1)</li>
                                <li><strong>Testing:</strong> Always test with <code>getAssetPrice()</code> and <code>getAssetInfo()</code> after configuration</li>
                            </ul>
                        </div>

                        <h3>🔄 Configuration Workflow</h3>
                        <div class="info-box green">
                            <ol>
                                <li><strong>Configure Base Asset</strong> - The token that will be supplied and borrowed (e.g., USDC)</li>
                                <li><strong>Configure Each Collateral Asset</strong> - All tokens borrowers can pledge as security</li>
                                <li><strong>Test Each Configuration</strong> - Use <code>getAssetPrice(address)</code> to verify oracles work</li>
                                <li><strong>Verify Settings</strong> - Use <code>getAssetInfo(address)</code> to confirm all parameters</li>
                                <li><strong>Check Oracle Count</strong> - Ensure you have enough active oracles per asset</li>
                            </ol>
                        </div>

                        <h3>Asset Configuration Parameters</h3>
                        <div class="code-block">
                            <pre><code class="language-solidity">struct Asset {
    uint8 active;                    // 1 = enabled, 0 = disabled
    uint8 decimals;                  // Token decimals (6 for USDC, 18 for ETH)
    uint16 borrowThreshold;          // Loan-to-value ratio (800 = 80%)
    uint16 liquidationThreshold;     // Liquidation threshold (850 = 85%)
    uint256 maxSupplyThreshold;      // Maximum supply cap
    uint256 isolationDebtCap;        // Debt cap for isolated assets
    uint8 assetMinimumOracles;       // Minimum required oracles
    address porFeed;                 // Proof of reserves feed
    OracleType primaryOracleType;    // CHAINLINK or UNISWAP_V3
    CollateralTier tier;             // STABLE, CROSS_A, CROSS_B, ISOLATED
    ChainlinkOracleConfig chainlinkConfig;
    UniswapPoolConfig poolConfig;
}</code></pre>
                        </div>

                        <div class="grid-2">
                            <div class="info-box purple">
                                <h5>🎯 Risk Tiers</h5>
                                <ul>
                                    <li><strong>STABLE (0):</strong> USDC, USDT, USD1 - 95% LTV</li>
                                    <li><strong>CROSS_A (1):</strong> WETH, WBTC - 80% LTV</li>
                                    <li><strong>CROSS_B (2):</strong> UNI, LINK - 70% LTV</li>
                                    <li><strong>ISOLATED (3):</strong> Other tokens - 60% LTV</li>
                                </ul>
                            </div>
                            
                            <div class="info-box yellow">
                                <h5>⚡ Oracle Setup Guide</h5>
                                <ul>
                                    <li><strong>Single Oracle:</strong> Chainlink for stablecoins</li>
                                    <li><strong>Dual Oracle:</strong> Chainlink + Uniswap for volatile assets</li>
                                    <li><strong>Median Price:</strong> Protocol uses median when both active</li>
                                    <li><strong>TWAP Period:</strong> 1800s (30min) recommended</li>
                                </ul>
                            </div>
                        </div>

                        <div class="info-box green">
                            <h5>🧪 Testing Your Configuration</h5>
                            <p>After configuring each asset, always test with these functions:</p>
                            <div class="code-block">
                                <pre><code class="language-solidity">getAssetPrice(0xAssetAddress)    // Returns price with 6 decimals
getAssetInfo(0xAssetAddress)     // Returns full config
getOracleCount(0xAssetAddress)   // Returns active oracles</code></pre>
                            </div>
                            <p><strong>💡 Pro Tip:</strong> Use the Asset Management tab in your market dashboard to test these functions!</p>
                        </div>
                    </section>

                    <section id="asset-examples">
                        <h2>Asset Configuration Examples</h2>
                        
                        <div class="tab-navigation">
                            <button class="tab-button active" onclick="showTab('usdc-tab')">💰 USDC (Base Asset)</button>
                            <button class="tab-button" onclick="showTab('weth-tab')">⚡ WETH (Dual Oracle)</button>
                            <button class="tab-button" onclick="showTab('usd1-tab')">🪙 USD1 (Stablecoin + Pool)</button>
                        </div>

                        <div id="usdc-tab" class="config-example">
                            <div style="margin-bottom: 16px; color: #10b981;">// Sample configuration for USDC as base asset</div>
                            <div style="margin-bottom: 8px;"><span style="color: #3b82f6;">Asset Address:</span> 0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48</div>
                            <div style="margin-bottom: 16px; color: #6b7280;">// Asset Configuration:</div>
                            <div style="margin-bottom: 4px;"><span style="color: #3b82f6;">active:</span> <span style="color: #fbbf24;">1</span> <span style="color: #6b7280;">// Enable the asset</span></div>
                            <div style="margin-bottom: 4px;"><span style="color: #3b82f6;">decimals:</span> <span style="color: #fbbf24;">6</span> <span style="color: #6b7280;">// USDC has 6 decimals</span></div>
                            <div style="margin-bottom: 4px;"><span style="color: #3b82f6;">borrowThreshold:</span> <span style="color: #fbbf24;">950</span> <span style="color: #6b7280;">// 95% LTV for stablecoin</span></div>
                            <div style="margin-bottom: 4px;"><span style="color: #3b82f6;">liquidationThreshold:</span> <span style="color: #fbbf24;">980</span> <span style="color: #6b7280;">// 98% liquidation threshold</span></div>
                            <div style="margin-bottom: 4px;"><span style="color: #3b82f6;">maxSupplyThreshold:</span> <span style="color: #fbbf24;">1000000000e6</span> <span style="color: #6b7280;">// 1B USDC (1B * 10^6)</span></div>
                            <div style="margin-bottom: 4px;"><span style="color: #3b82f6;">isolationDebtCap:</span> <span style="color: #fbbf24;">0</span> <span style="color: #6b7280;">// No isolation for base asset</span></div>
                            <div style="margin-bottom: 4px;"><span style="color: #3b82f6;">assetMinimumOracles:</span> <span style="color: #fbbf24;">1</span> <span style="color: #6b7280;">// Require at least 1 oracle</span></div>
                            <div style="margin-bottom: 4px;"><span style="color: #3b82f6;">primaryOracleType:</span> <span style="color: #fbbf24;">CHAINLINK</span> <span style="color: #6b7280;">// Use Chainlink as primary</span></div>
                            <div style="margin-bottom: 16px;"><span style="color: #3b82f6;">tier:</span> <span style="color: #fbbf24;">STABLE</span> <span style="color: #6b7280;">// Tier 0 = STABLE (lowest risk)</span></div>
                            
                            <div style="margin-bottom: 8px; color: #6b7280;">// Chainlink Oracle Configuration:</div>
                            <div style="margin-bottom: 4px;"><span style="color: #3b82f6;">oracleUSD:</span> 0x8fFfFfd4AfB6115b954Bd326cbe7B4BA576818f6 <span style="color: #6b7280;">// USDC/USD feed</span></div>
                            <div style="margin-bottom: 16px;"><span style="color: #3b82f6;">active:</span> <span style="color: #fbbf24;">1</span> <span style="color: #6b7280;">// Enable Chainlink oracle</span></div>
                            
                            <div style="margin-bottom: 8px; color: #6b7280;">// Uniswap Pool Configuration (disabled for stablecoin):</div>
                            <div style="margin-bottom: 4px;"><span style="color: #3b82f6;">pool:</span> 0x0000000000000000000000000000000000000000 <span style="color: #6b7280;">// Not using Uniswap</span></div>
                            <div style="margin-bottom: 4px;"><span style="color: #3b82f6;">twapPeriod:</span> <span style="color: #fbbf24;">0</span></div>
                            <div><span style="color: #3b82f6;">active:</span> <span style="color: #fbbf24;">0</span> <span style="color: #6b7280;">// Disabled</span></div>
                        </div>

                        <div id="weth-tab" class="config-example" style="display: none;">
                            <div style="margin-bottom: 16px; color: #10b981;">// WETH configuration with both Chainlink and Uniswap oracles</div>
                            <div style="margin-bottom: 8px;"><span style="color: #3b82f6;">Asset Address:</span> 0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2</div>
                            <div style="margin-bottom: 16px; color: #6b7280;">// Asset Configuration:</div>
                            <div style="margin-bottom: 4px;"><span style="color: #3b82f6;">active:</span> <span style="color: #fbbf24;">1</span> <span style="color: #6b7280;">// Enable the asset</span></div>
                            <div style="margin-bottom: 4px;"><span style="color: #3b82f6;">decimals:</span> <span style="color: #fbbf24;">18</span> <span style="color: #6b7280;">// WETH has 18 decimals</span></div>
                            <div style="margin-bottom: 4px;"><span style="color: #3b82f6;">borrowThreshold:</span> <span style="color: #fbbf24;">800</span> <span style="color: #6b7280;">// 80% LTV for blue chip</span></div>
                            <div style="margin-bottom: 4px;"><span style="color: #3b82f6;">liquidationThreshold:</span> <span style="color: #fbbf24;">850</span> <span style="color: #6b7280;">// 85% liquidation threshold</span></div>
                            <div style="margin-bottom: 4px;"><span style="color: #3b82f6;">maxSupplyThreshold:</span> <span style="color: #fbbf24;">1000000 ether</span> <span style="color: #6b7280;">// 1M WETH maximum</span></div>
                            <div style="margin-bottom: 4px;"><span style="color: #3b82f6;">isolationDebtCap:</span> <span style="color: #fbbf24;">0</span> <span style="color: #6b7280;">// No isolation (cross-collateral)</span></div>
                            <div style="margin-bottom: 4px;"><span style="color: #3b82f6;">assetMinimumOracles:</span> <span style="color: #fbbf24;">1</span> <span style="color: #6b7280;">// Require at least 1 oracle</span></div>
                            <div style="margin-bottom: 4px;"><span style="color: #3b82f6;">primaryOracleType:</span> <span style="color: #fbbf24;">CHAINLINK</span> <span style="color: #6b7280;">// Use Chainlink as primary</span></div>
                            <div style="margin-bottom: 16px;"><span style="color: #3b82f6;">tier:</span> <span style="color: #fbbf24;">CROSS_A</span> <span style="color: #6b7280;">// Tier 1 = Blue chip asset</span></div>
                            
                            <div style="margin-bottom: 8px; color: #6b7280;">// Chainlink Oracle Configuration:</div>
                            <div style="margin-bottom: 4px;"><span style="color: #3b82f6;">oracleUSD:</span> 0x5f4eC3Df9cbd43714FE2740f5E3616155c5b8419 <span style="color: #6b7280;">// ETH/USD price feed</span></div>
                            <div style="margin-bottom: 16px;"><span style="color: #3b82f6;">active:</span> <span style="color: #fbbf24;">1</span> <span style="color: #6b7280;">// Enable Chainlink oracle</span></div>
                            
                            <div style="margin-bottom: 8px; color: #6b7280;">// Uniswap V3 Pool Configuration (dual oracle setup):</div>
                            <div style="margin-bottom: 4px;"><span style="color: #3b82f6;">pool:</span> 0x88e6A0c2dDD26FEEb64F039a2c41296FcB3f5640 <span style="color: #6b7280;">// WETH/USDC 0.05% pool</span></div>
                            <div style="margin-bottom: 4px;"><span style="color: #3b82f6;">twapPeriod:</span> <span style="color: #fbbf24;">1800</span> <span style="color: #6b7280;">// 30 minutes TWAP</span></div>
                            <div style="margin-bottom: 8px;"><span style="color: #3b82f6;">active:</span> <span style="color: #fbbf24;">1</span> <span style="color: #6b7280;">// Enable Uniswap oracle</span></div>
                            
                            <div style="margin-bottom: 8px; color: #10b981;">// 🔥 Dual Oracle Benefits:</div>
                            <div style="margin-bottom: 4px; color: #6b7280;">// - Median price from both sources increases security</div>
                            <div style="margin-bottom: 4px; color: #6b7280;">// - Protection against oracle manipulation attacks</div>
                            <div style="margin-bottom: 4px; color: #6b7280;">// - Fallback if one oracle fails</div>
                            <div style="color: #6b7280;">// - More accurate pricing during high volatility</div>
                        </div>

                        <div id="usd1-tab" class="config-example" style="display: none;">
                            <div style="margin-bottom: 16px; color: #10b981;">// USD1 stablecoin with dual oracle for enhanced security</div>
                            <div style="margin-bottom: 8px;"><span style="color: #3b82f6;">Asset Address:</span> 0x8d0D000Ee44948FC98c9B98A4FA4921476f08B0d</div>
                            <div style="margin-bottom: 16px; color: #6b7280;">// Asset Configuration:</div>
                            <div style="margin-bottom: 4px;"><span style="color: #3b82f6;">active:</span> <span style="color: #fbbf24;">1</span> <span style="color: #6b7280;">// Enable the asset</span></div>
                            <div style="margin-bottom: 4px;"><span style="color: #3b82f6;">decimals:</span> <span style="color: #fbbf24;">18</span> <span style="color: #6b7280;">// USD1 has 18 decimals (unlike USDC/USDT)</span></div>
                            <div style="margin-bottom: 4px;"><span style="color: #3b82f6;">borrowThreshold:</span> <span style="color: #fbbf24;">950</span> <span style="color: #6b7280;">// 95% LTV for stablecoin</span></div>
                            <div style="margin-bottom: 4px;"><span style="color: #3b82f6;">liquidationThreshold:</span> <span style="color: #fbbf24;">980</span> <span style="color: #6b7280;">// 98% liquidation threshold</span></div>
                            <div style="margin-bottom: 4px;"><span style="color: #3b82f6;">maxSupplyThreshold:</span> <span style="color: #fbbf24;">1000000000e18</span> <span style="color: #6b7280;">// 1B USD1 (1B * 10^18)</span></div>
                            <div style="margin-bottom: 4px;"><span style="color: #3b82f6;">isolationDebtCap:</span> <span style="color: #fbbf24;">0</span> <span style="color: #6b7280;">// No isolation for stablecoin</span></div>
                            <div style="margin-bottom: 4px;"><span style="color: #3b82f6;">assetMinimumOracles:</span> <span style="color: #fbbf24;">1</span> <span style="color: #6b7280;">// Require at least 1 oracle</span></div>
                            <div style="margin-bottom: 4px;"><span style="color: #3b82f6;">primaryOracleType:</span> <span style="color: #fbbf24;">CHAINLINK</span> <span style="color: #6b7280;">// Use Chainlink as primary</span></div>
                            <div style="margin-bottom: 16px;"><span style="color: #3b82f6;">tier:</span> <span style="color: #fbbf24;">STABLE</span> <span style="color: #6b7280;">// Tier 0 = STABLE (lowest risk)</span></div>
                            
                            <div style="margin-bottom: 8px; color: #6b7280;">// Chainlink Oracle Configuration:</div>
                            <div style="margin-bottom: 4px;"><span style="color: #3b82f6;">oracleUSD:</span> 0xF0d9bb015Cd7BfAb877B7156146dc09Bf461370d <span style="color: #6b7280;">// USD1/USD feed</span></div>
                            <div style="margin-bottom: 16px;"><span style="color: #3b82f6;">active:</span> <span style="color: #fbbf24;">1</span> <span style="color: #6b7280;">// Enable Chainlink oracle</span></div>
                            
                            <div style="margin-bottom: 8px; color: #6b7280;">// Uniswap V3 Pool Configuration (dual oracle for extra security):</div>
                            <div style="margin-bottom: 4px;"><span style="color: #3b82f6;">pool:</span> 0x4e68Ccd3E89f51C3074ca5072bbAC773960dFa36 <span style="color: #6b7280;">// WETH/USD1 pool</span></div>
                            <div style="margin-bottom: 4px;"><span style="color: #3b82f6;">twapPeriod:</span> <span style="color: #fbbf24;">1800</span> <span style="color: #6b7280;">// 30 minutes TWAP</span></div>
                            <div style="margin-bottom: 8px;"><span style="color: #3b82f6;">active:</span> <span style="color: #fbbf24;">1</span> <span style="color: #6b7280;">// Enable Uniswap oracle</span></div>
                            
                            <div style="margin-bottom: 8px; color: #f59e0b;">// ⚠️ Important USD1 Notes:</div>
                            <div style="margin-bottom: 4px; color: #6b7280;">// - USD1 has 18 decimals (different from USDC/USDT with 6)</div>
                            <div style="margin-bottom: 4px; color: #6b7280;">// - Uses WETH/USD1 pool for Uniswap pricing</div>
                            <div style="margin-bottom: 4px; color: #6b7280;">// - Dual oracle recommended for newer stablecoins</div>
                            <div style="color: #6b7280;">// - Monitor both oracle feeds for price stability</div>
                        </div>
                    </section>

                    <section id="deploy-liquidity">
                        <h2>Step 3: Deploy Initial Liquidity</h2>
                        <p>Bootstrap your market by supplying the initial liquidity. This provides the base asset pool that borrowers can draw from when they deposit collateral.</p>

                        <div class="grid-2">
                            <div class="info-box green">
                                <h5>✅ Best Practices</h5>
                                <ul>
                                    <li>Supply meaningful initial liquidity (e.g., $10K+)</li>
                                    <li>Monitor utilization rate (borrowed/supplied)</li>
                                    <li>Watch borrow/supply APY spread</li>
                                    <li>Consider LP incentives to attract lenders</li>
                                </ul>
                            </div>
                            
                            <div class="info-box blue">
                                <h5>📊 What to Monitor</h5>
                                <ul>
                                    <li>Total Value Locked (TVL)</li>
                                    <li>Utilization rate</li>
                                    <li>Supply and borrow APY</li>
                                    <li>Number of active positions</li>
                                </ul>
                            </div>
                        </div>

                        <div class="code-block">
                            <pre><code class="language-solidity">// Supply initial liquidity to your market
uint256 initialAmount = 10_000e6; // 10k USDC
usdc.approve(address(marketCore), initialAmount);

uint256 expectedShares = marketVault.previewDeposit(initialAmount);
marketCore.depositLiquidity(initialAmount, expectedShares, 100); // 1% slippage</code></pre>
                        </div>
                    </section>

                    <section id="manage-market">
                        <h2>Step 4: Manage Your Market</h2>
                        <p>After launching your market, ongoing management is crucial for success and profitability.</p>

                        <div class="step-card">
                            <div class="step-number">1</div>
                            <div class="step-title">Monitor Market Health</div>
                            <p>Keep track of key metrics and user activity.</p>
                            
                            <div class="info-box blue">
                                <strong>Key Monitoring Functions:</strong>
                                <ul>
                                    <li><strong>getMarketInfo(owner, baseAsset):</strong> Get all contract addresses and configuration</li>
                                    <li><strong>isMarketActive(owner, baseAsset):</strong> Check if your market is currently active</li>
                                    <li><strong>Market analytics:</strong> Track TVL, utilization, and user activity</li>
                                    <li><strong>Revenue monitoring:</strong> Monitor flash loan fees and protocol commissions</li>
                                </ul>
                            </div>
                        </div>

                        <div class="step-card">
                            <div class="step-number">2</div>
                            <div class="step-title">Adjust Market Parameters</div>
                            <p>Optimize your market's performance by adjusting settings.</p>
                            
                            <div class="info-box yellow">
                                <strong>Configurable Parameters:</strong>
                                <ul>
                                    <li><strong>Interest rate models:</strong> Adjust base rates and utilization curves</li>
                                    <li><strong>Flash loan fees:</strong> Set competitive fees for flash loan services</li>
                                    <li><strong>Collateral assets:</strong> Add new collateral types for borrowers</li>
                                    <li><strong>Risk parameters:</strong> Configure loan-to-value ratios and liquidation thresholds</li>
                                </ul>
                            </div>
                        </div>

                        <div class="step-card">
                            <div class="step-number">3</div>
                            <div class="step-title">Manage Risk</div>
                            <p>Ensure your market remains healthy and profitable.</p>
                            
                            <div class="info-box red">
                                <strong>Risk Management Tasks:</strong>
                                <ul>
                                    <li>Monitor position health factors regularly</li>
                                    <li>Adjust LTV ratios based on asset volatility</li>
                                    <li>Update oracle configurations as needed</li>
                                    <li>Manage supply caps and debt limits</li>
                                    <li>Respond to market stress events</li>
                                </ul>
                            </div>
                        </div>
                    </section>

                    <section id="revenue-streams">
                        <h2>Revenue Streams</h2>
                        <p>As a market owner, you earn revenue from multiple sources within your market ecosystem.</p>

                        <div class="grid-2">
                            <div class="info-box green">
                                <h5>💰 Primary Revenue</h5>
                                <ul>
                                    <li><strong>Interest Rate Spreads:</strong> Borrowers pay higher rates than lenders receive</li>
                                    <li><strong>Flash Loan Fees:</strong> 0.09% fee on all flash loan transactions</li>
                                    <li><strong>Liquidation Proceeds:</strong> Profits from liquidating unhealthy positions</li>
                                    <li><strong>Protocol Commissions:</strong> Share of overall protocol revenue</li>
                                </ul>
                            </div>
                            
                            <div class="info-box blue">
                                <h5>📈 Growth Opportunities</h5>
                                <ul>
                                    <li><strong>Market Expansion:</strong> Add new collateral assets</li>
                                    <li><strong>Yield Optimization:</strong> Fine-tune interest rate curves</li>
                                    <li><strong>Integration Partnerships:</strong> Connect with other DeFi protocols</li>
                                    <li><strong>Incentive Programs:</strong> Attract users with rewards</li>
                                </ul>
                            </div>
                        </div>
                    </section>

                    <section id="best-practices">
                        <h2>Best Practices</h2>

                        <div class="grid-2">
                            <div class="info-box green">
                                <h5>✅ Do's</h5>
                                <ul>
                                    <li>Start with conservative LTV ratios</li>
                                    <li>Test all configurations thoroughly</li>
                                    <li>Monitor your market daily</li>
                                    <li>Keep oracle feeds up to date</li>
                                    <li>Maintain adequate liquidity buffers</li>
                                    <li>Document your configuration decisions</li>
                                </ul>
                            </div>
                            
                            <div class="info-box red">
                                <h5>⚠️ Don'ts</h5>
                                <ul>
                                    <li>Don't launch without testing all assets</li>
                                    <li>Don't set aggressive LTV ratios initially</li>
                                    <li>Don't ignore market stress events</li>
                                    <li>Don't configure assets without active oracles</li>
                                    <li>Don't forget to update configurations regularly</li>
                                    <li>Don't ignore user feedback and market demands</li>
                                </ul>
                            </div>
                        </div>
                    </section>

                    <section id="quick-reference">
                        <h2>Quick Reference</h2>
                        
                        <div class="grid-2">
                            <div class="info-box purple">
                                <h5>Common LTV Ratios</h5>
                                <div>
                                    <div><strong>Stablecoins:</strong> 80-90%</div>
                                    <div><strong>Blue Chips:</strong> 70-80%</div>
                                    <div><strong>Mid Caps:</strong> 60-70%</div>
                                    <div><strong>Long Tail:</strong> 40-60%</div>
                                </div>
                            </div>
                            
                            <div class="info-box green">
                                <h5>Asset Decimals Reference</h5>
                                <div>
                                    <div><strong>USDC, USDT:</strong> 6 decimals</div>
                                    <div><strong>WBTC:</strong> 8 decimals</div>
                                    <div><strong>ETH, USD1, most ERC-20:</strong> 18 decimals</div>
                                </div>
                            </div>
                        </div>

                        <div class="info-box blue">
                            <h5>Essential Functions</h5>
                            <div class="code-block">
                                <pre><code class="language-solidity">// Market Management
factory.createMarket(baseAsset, name, symbol)
factory.getMarketInfo(owner, baseAsset)
factory.isMarketActive(owner, baseAsset)

// Asset Configuration
assets.updateAssetConfig(assetAddress, assetConfig)
assets.getAssetPrice(assetAddress)
assets.getAssetInfo(assetAddress)

// Market Operations
marketCore.depositLiquidity(amount, expectedShares, slippage)
marketVault.totalBase()
marketVault.utilization()</code></pre>
                            </div>
                        </div>
                    </section>
                </div>
            </div>
        </div>
    </main>

    <!-- Prism.js for syntax highlighting -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    
    <script>
        function showTab(tabId) {
            // Hide all tabs
            document.getElementById('usdc-tab').style.display = 'none';
            document.getElementById('weth-tab').style.display = 'none';
            document.getElementById('usd1-tab').style.display = 'none';
            
            // Remove active class from all buttons
            const buttons = document.querySelectorAll('.tab-button');
            buttons.forEach(btn => btn.classList.remove('active'));
            
            // Show selected tab
            document.getElementById(tabId).style.display = 'block';
            
            // Add active class to clicked button
            event.target.classList.add('active');
        }
    </script>
</body>
</html>